<!-- users – 회원 계정 기본 정보 -->
| 컬럼명             | 타입           | 필수 | 설명                                         |
| --------------- | ------------ | -- | ------------------------------------------ |
| id              | BIGINT PK    | Y  | 사용자 고유 ID (시스템 내부 키)                       |
| email           | VARCHAR(255) | Y  | 로그인 ID / 이메일, 유니크                          |
| password_hash   | VARCHAR(255) | N  | 비밀번호 해시 (소셜 전용 계정이면 NULL)                  |
| email_verified  | BOOLEAN      | Y  | 이메일 인증 여부                                  |
| status          | VARCHAR(50)  | Y  | 계정 상태 (`active`, `suspended`, `deleted` 등) |
| sign_up_channel | VARCHAR(50)  | N  | 가입 경로 (`web`, `admin`, `partner` 등)        |
| locale          | VARCHAR(10)  | N  | 언어 코드 (`ko`, `en` 등)                       |
| timezone        | VARCHAR(50)  | N  | 시간대 (`Asia/Seoul`)                         |
| created_at      | TIMESTAMP    | Y  | 생성 시각                                      |
| updated_at      | TIMESTAMP    | Y  | 수정 시각                                      |


<!-- user_profiles – 회원 상세 프로필 -->
| 컬럼명          | 타입           | 필수 | 설명                                    |
| ------------- | ------------ | -- | ------------------------------------- |
| id            | BIGINT PK    | Y  | 프로필 고유 ID                             |
| user_id       | BIGINT FK    | Y  | users.id 참조                          |
| name          | VARCHAR(100) | N  | 사용자 이름                                 |
| phone_number  | VARCHAR(50)  | N  | 연락처                                     |
| company_name  | VARCHAR(255) | N  | 회사명                                     |
| department    | VARCHAR(255) | N  | 부서                                      |
| job_title     | VARCHAR(255) | N  | 직책                                      |
| company_size  | VARCHAR(50)  | N  | 회사 규모 (`1-10`, `11-50` 등)             |
| address_line1 | VARCHAR(255) | N  | 주소 1                                     |
| address_line2 | VARCHAR(255) | N  | 주소 2                                     |
| city          | VARCHAR(100) | N  | 도시                                      |
| state         | VARCHAR(100) | N  | 주/도                                     |
| postal_code   | VARCHAR(20)  | N  | 우편번호                                    |
| country       | VARCHAR(100) | N  | 국가                                      |
| extra_meta    | JSON         | N  | 추가 메타 정보 (내부 메모, 태그 등)                 |
| created_at    | TIMESTAMP    | Y  | 생성 시각                                   |
| updated_at    | TIMESTAMP    | Y  | 수정 시각                                   |


<!-- user_auth_providers – 소셜 로그인/외부 인증 -->
| 컬럼명            | 타입           | 필수 | 설명                                                                     |
| --------------- | ------------ | -- | ---------------------------------------------------------------------- |
| id              | BIGINT PK    | Y  | 고유 ID                                                                  |
| user_id         | BIGINT FK    | Y  | users.id 참조                                                           |
| provider        | VARCHAR(50)  | Y  | 인증 제공자 (`google`, `kakao`, `naver`, `github` 등)                      |
| provider_user_id| VARCHAR(255) | Y  | 해당 provider 내 유저 고유 ID                                               |
| access_token    | TEXT         | N  | 액세스 토큰                                                                 |
| refresh_token   | TEXT         | N  | 리프레시 토큰                                                               |
| token_expires_at| TIMESTAMP    | N  | 토큰 만료 시각                                                               |
| raw_profile     | JSON         | N  | provider에서 받은 원본 프로필 JSON                                           |
| created_at      | TIMESTAMP    | Y  | 생성 시각                                                                   |
| updated_at      | TIMESTAMP    | Y  | 수정 시각                                                                   |


<!-- user_roles – 역할(권한) 정의 -->
| 컬럼명       | 타입           | 필수 | 설명                            |
| ---------- | ------------ | -- | ----------------------------- |
| id         | BIGINT PK    | Y  | 역할 고유 ID                       |
| code       | VARCHAR(50)  | Y  | 역할 코드 (`admin`, `user` 등)     |
| name       | VARCHAR(100) | Y  | 표시용 이름 (`관리자`, `일반 사용자`)   |
| description| TEXT         | N  | 역할 설명                         |


<!-- user_role_mappings – 사용자 ↔ 역할 매핑 -->
| 컬럼명       | 타입        | 필수 | 설명                                |
| ---------- | --------- | -- | --------------------------------- |
| id         | BIGINT PK | Y  | 매핑 고유 ID                           |
| user_id    | BIGINT FK | Y  | users.id 참조                        |
| role_id    | BIGINT FK | Y  | user_roles.id 참조                   |
| created_at | TIMESTAMP | Y  | 역할 부여 시각                           |


<!-- user_status_logs – 회원 상태 변경 이력 -->
| 컬럼명       | 타입        | 필수 | 설명                                                        |
| ---------- | --------- | -- | --------------------------------------------------------- |
| id         | BIGINT PK | Y  | 이력 고유 ID                                                   |
| user_id    | BIGINT FK | Y  | users.id 참조                                              |
| from_status| VARCHAR(50)| N  | 변경 전 상태                                                   |
| to_status  | VARCHAR(50)| Y  | 변경 후 상태 (`active`, `suspended`, `deleted` 등)          |
| reason     | TEXT       | N  | 상태 변경 사유 (내부 메모)                                       |
| changed_by | BIGINT     | N  | 변경을 수행한 관리자 user_id (자동/시스템이면 NULL)                |
| created_at | TIMESTAMP  | Y  | 변경 시각                                                      |


<!-- products – 솔루션(상품) -->
| 컬럼명      | 타입           | 필수 | 설명                                            |
| --------- | ------------ | -- | --------------------------------------------- |
| id        | BIGINT PK    | Y  | 상품 ID                                         |
| code      | VARCHAR(50)  | Y  | 상품 코드 (`OPENFIRE`, `BULC` 등), 유니크              |
| name      | VARCHAR(255) | Y  | 상품 이름                                         |
| description| TEXT        | N  | 상품 설명                                         |
| is_active | BOOLEAN      | Y  | 판매 여부 (TRUE=판매중)                            |
| created_at| TIMESTAMP    | Y  | 생성 시각                                         |
| updated_at| TIMESTAMP    | Y  | 수정 시각                                         |


<!-- price_plans – 요금제/가격 -->
| 컬럼명       | 타입           | 필수 | 설명                                       |
| ---------- | ------------ | -- | ---------------------------------------- |
| id         | BIGINT PK    | Y  | 요금제 ID                                   |
| product_id | BIGINT FK    | Y  | products.id 참조                           |
| name       | VARCHAR(255) | Y  | 요금제 이름 (`월간 기본`, `연간 프로` 등)            |
| billing_type | VARCHAR(50)| Y  | 청구 방식 (`one_time`, `recurring`)        |
| billing_period | VARCHAR(50)| N | 구독 주기 (`month`, `year` 등, 1회 결제는 NULL)    |
| amount     | DECIMAL(18,2)| Y  | 결제 금액                                   |
| currency   | VARCHAR(10)  | Y  | 통화 (`KRW` 등)                            |
| is_active  | BOOLEAN      | Y  | 판매 중인 요금제 여부                          |
| created_at | TIMESTAMP    | Y  | 생성 시각                                   |
| updated_at | TIMESTAMP    | Y  | 수정 시각                                   |


<!-- subscriptions – 구독 정보 -->
컬럼명	타입	필수	설명
id	BIGINT PK	Y	구독 ID
user_id	BIGINT FK	Y	users.id 참조
price_plan_id	BIGINT FK	Y	price_plans.id 참조
status	VARCHAR(50)	Y	구독 상태 (active, canceled, expired, past_due 등)
current_period_start	TIMESTAMP	Y	현재 청구 기간 시작 시각
current_period_end	TIMESTAMP	Y	현재 청구 기간 종료 시각
cancel_at_period_end	BOOLEAN	Y	다음 만료 시점에 해지 예정인지 여부
canceled_at	TIMESTAMP	N	실제 해지 처리 시각
created_at	TIMESTAMP	Y	구독 생성 시각
updated_at	TIMESTAMP	Y	구독 정보 수정 시각


<!-- orders – 주문 -->
| 컬럼명        | 타입           | 필수 | 설명                                                      |
|-------------|----------------|------|-----------------------------------------------------------|
| id          | BIGINT PK      | Y    | 주문 ID                                                   |
| user_id     | BIGINT FK      | Y    | users.id 참조                                             |
| order_number| VARCHAR(100)   | Y    | 외부 노출용 주문번호, 유니크                                     |
| status      | VARCHAR(50)    | Y    | 주문 상태 (`pending`, `paid`, `canceled`, `failed` 등)      |
| order_type  | VARCHAR(50)    | Y    | 주문 유형 (`one_time`, `subscription_initial`, `subscription_renewal`) |
| total_amount| DECIMAL(18,2)  | Y    | 총 결제 금액                                                 |
| currency    | VARCHAR(10)    | Y    | 통화 (`KRW` 등)                                           |
| note        | TEXT           | N    | 내부 메모                                                   |
| created_at  | TIMESTAMP      | Y    | 주문 생성 시각                                               |
| updated_at  | TIMESTAMP      | Y    | 주문 수정 시각                                               |


<!-- order_items – 주문 항목 -->
| 컬럼명       | 타입           | 필수 | 설명                                  |
|------------|----------------|------|---------------------------------------|
| id         | BIGINT PK      | Y    | 주문 항목 ID                              |
| order_id   | BIGINT FK      | Y    | orders.id 참조                         |
| product_id | BIGINT FK      | Y    | products.id 참조                       |
| price_plan_id | BIGINT FK   | N    | price_plans.id 참조 (1회 상품이면 NULL)    |
| quantity   | INT            | Y    | 수량, 기본값 1                            |
| unit_amount| DECIMAL(18,2)  | Y    | 단가                                   |
| total_amount| DECIMAL(18,2) | Y    | 항목 총액                                |
| metadata   | JSON           | N    | 라이선스 수량, 좌석 수 등 확장 정보             |
| created_at | TIMESTAMP      | Y    | 생성 시각                                 |


<!-- payments – 결제 -->
| 컬럼명              | 타입           | 필수 | 설명                                                                 |
|-------------------|----------------|------|----------------------------------------------------------------------|
| id                | BIGINT PK      | Y    | 결제 ID                                                              |
| order_id          | BIGINT FK      | Y    | orders.id 참조                                                       |
| user_id           | BIGINT FK      | Y    | users.id 참조                                                        |
| provider          | VARCHAR(50)    | Y    | PG/결제 제공자 (`toss`, `inicis`, `stripe` 등)                            |
| provider_payment_id | VARCHAR(255) | Y    | PG 측 결제 ID                                                         |
| amount            | DECIMAL(18,2)  | Y    | 결제 금액                                                              |
| currency          | VARCHAR(10)    | Y    | 통화 (`KRW` 등)                                                      |
| status            | VARCHAR(50)    | Y    | 결제 상태 (`pending`, `paid`, `failed`, `canceled`, `refunded` 등)     |
| paid_at           | TIMESTAMP      | N    | 실제 결제 완료 시각                                                     |
| failure_reason    | TEXT           | N    | 실패 사유                                                               |
| raw_response      | JSON           | N    | PG에서 받은 원본 응답                                                     |
| created_at        | TIMESTAMP      | Y    | 생성 시각                                                               |
| updated_at        | TIMESTAMP      | Y    | 수정 시각                                                               |


<!-- refunds – 환불 -->
| 컬럼명           | 타입           | 필수 | 설명                                               |
|----------------|----------------|------|----------------------------------------------------|
| id             | BIGINT PK      | Y    | 환불 ID                                            |
| payment_id     | BIGINT FK      | Y    | payments.id 참조                                   |
| refund_amount  | DECIMAL(18,2)  | Y    | 환불 금액                                            |
| reason         | TEXT           | N    | 환불 사유                                            |
| status         | VARCHAR(50)    | Y    | 환불 상태 (`pending`, `completed`, `failed`)        |
| provider_refund_id | VARCHAR(255)| N   | PG 측 환불 ID                                       |
| refunded_at    | TIMESTAMP      | N    | 실제 환불 완료 시각                                   |
| raw_response   | JSON           | N    | PG 환불 응답 원본                                     |
| created_at     | TIMESTAMP      | Y    | 생성 시각                                            |
| updated_at     | TIMESTAMP      | Y    | 수정 시각                                            |


<!-- user_activity_logs – 사용자 활동 로그 -->
| 컬럼명        | 타입           | 필수 | 설명                                                                 |
|-------------|----------------|------|----------------------------------------------------------------------|
| id          | BIGINT PK      | Y    | 활동 로그 ID                                                            |
| user_id     | BIGINT FK      | N    | users.id 참조, 비로그인 사용자는 NULL                                       |
| action      | VARCHAR(100)   | Y    | 동작 유형 (`page_view`, `button_click`, `login`, `logout` 등)            |
| resource_path| VARCHAR(500)  | N    | 웹 URL 또는 API 경로                                                      |
| http_method | VARCHAR(10)    | N    | HTTP 메서드 (GET, POST 등)                                               |
| ip_address  | VARCHAR(50)    | N    | IP 주소                                                                |
| user_agent  | TEXT           | N    | 브라우저/클라이언트 정보                                                   |
| referrer    | VARCHAR(500)   | N    | 이전 페이지/Referrer                                                    |
| metadata    | JSON           | N    | 버튼 ID, 상품 ID, 에러 내용 등 상세 정보                                      |
| created_at  | TIMESTAMP      | Y    | 이벤트 발생 시각                                                           |


<!-- admin_operation_logs – 관리자 운영 로그 -->
| 컬럼명        | 타입           | 필수 | 설명                                                            |
|-------------|----------------|------|-----------------------------------------------------------------|
| id          | BIGINT PK      | Y    | 관리자 로그 ID                                                     |
| admin_user_id | BIGINT FK    | Y    | 관리자 계정 users.id 참조                                           |
| action      | VARCHAR(100)   | Y    | 작업 유형 (`user_suspend`, `subscription_cancel` 등)                |
| target_type | VARCHAR(50)    | Y    | 대상 타입 (`user`, `subscription`, `order`, `payment`, `refund` 등) |
| target_id   | BIGINT         | N    | 대상 객체 ID                                                       |
| target_user_id | BIGINT FK   | N    | 관련 사용자 ID (users.id 참조)                                      |
| description | TEXT           | N    | 상세 내용/사유                                                       |
| ip_address  | VARCHAR(50)    | N    | 관리자 IP 주소                                                       |
| user_agent  | TEXT           | N    | 브라우저/클라이언트 정보                                              |
| created_at  | TIMESTAMP      | Y    | 작업 시각                                                           |


<!-- verifications – 이메일/전화 인증 및 비밀번호 재설정 코드 공통 테이블 -->
| 컬럼명        | 타입           | 필수 | 설명                                                                 |
|-------------|----------------|------|----------------------------------------------------------------------|
| id          | BIGINT PK      | Y    | 인증 레코드 고유 ID                                                  |
| user_id     | BIGINT FK      | N    | users.id 참조, 가입 전 인증 등에서는 NULL 가능                                |
| channel     | VARCHAR(20)    | Y    | 인증 채널 (`email`, `phone` 등)                                      |
| target_value| VARCHAR(255)   | Y    | 인증 대상 값 (이메일 주소, 전화번호 등)                                      |
| purpose     | VARCHAR(50)    | Y    | 인증 목적 (`signup`, `password_reset`, `login`, `change_contact`, `2fa` 등) |
| code        | VARCHAR(50)    | Y    | 인증 코드/토큰 (이메일 토큰, SMS 숫자 코드 등)                                |
| expires_at  | TIMESTAMP      | Y    | 코드 유효 기간                                                        |
| verified_at | TIMESTAMP      | N    | 실제 인증 완료 시각                                                     |
| attempt_count| INT           | Y    | 시도 횟수, 기본값 0                                                   |
| status      | VARCHAR(20)    | Y    | 상태 (`pending`, `verified`, `expired`, `canceled`)                   |
| created_at  | TIMESTAMP      | Y    | 생성 시각                                                            |


<!-- auth_login_attempts – 로그인 시도(보안) 기록 -->
| 컬럼명        | 타입           | 필수 | 설명                                                       |
|-------------|----------------|------|------------------------------------------------------------|
| id          | BIGINT PK      | Y    | 로그인 시도 고유 ID                                          |
| user_id     | BIGINT FK      | N    | users.id 참조, 이메일로 사용자를 찾지 못한 경우 NULL                 |
| email       | VARCHAR(255)   | N    | 로그인 시 사용자가 입력한 이메일/아이디                               |
| success     | BOOLEAN        | Y    | 로그인 성공 여부                                             |
| failure_reason | VARCHAR(100)| N    | 실패 사유 (`INVALID_PASSWORD`, `USER_NOT_FOUND`, `LOCKED` 등) |
| ip_address  | VARCHAR(50)    | N    | 로그인 시도 IP 주소                                          |
| user_agent  | TEXT           | N    | 브라우저/클라이언트 정보                                       |
| created_at  | TIMESTAMP      | Y    | 시도 시각                                                   |


<!-- 인덱스 요약 (핵심 컬럼 위주) -->
- users  
  - `email` : UNIQUE 인덱스 (로그인/중복 체크)  
  - `status`, `email_verified`, `created_at` : 조회/대시보드용 인덱스

- user_profiles  
  - `user_id` : FK 조회용 인덱스

- user_auth_providers  
  - `(provider, provider_user_id)` : UNIQUE 인덱스 (소셜 로그인 매핑)

- user_role_mappings  
  - `user_id`, `role_id` : 권한 조회용 인덱스

- subscriptions  
  - `user_id`, `status`, `current_period_end` : 구독 상태/만료일 조회용 인덱스

- orders / payments / refunds  
  - `order_number`, `user_id`, `status`, `created_at` : 주문/결제 검색 및 대시보드용 인덱스

- user_activity_logs / admin_operation_logs  
  - `user_id`, `admin_user_id`, `action`, `created_at` : 로그/감사 조회용 인덱스

- verifications  
  - `(channel, target_value, purpose, status)` : 인증코드 검증 및 최근 시도 조회용 인덱스

- auth_login_attempts  
  - `user_id`, `email`, `(ip_address, created_at)` : 보안 정책(잠금, 공격 탐지)용 인덱스
